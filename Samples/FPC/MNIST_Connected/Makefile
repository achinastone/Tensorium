#
# Don't edit, this file is generated by FPCMake Version 2.0.0
#
default: all

# enable intel's SIMD
USE_AVX2=1

#thread pooling
USE_STEROIDS=0
USE_OPENBLAS=1
USE_TELEMETRY=0
USE_MKL=0
USE_OPENCL=1
CLBLASTCONV=1

FPC=fpc
UNITS =../../../source
OUTLIB=lib
INCLIB=

SRC=MNISTConnected
SRC_EXT=.pas

ifeq ($(OS), Windows_NT)
DEL=rm -rf
MKD=mkdir -p
EXE_EXT=.exe
#ifdef ComSpec
#SHELL := $(ComSpec)
#endif
#ifdef COMSPEC
#SHELL := $(COMSPEC)
#endif
else
DEL=rm -rf
MKD=mkdir -p
endif

ifeq ($(USE_AVX2),1)
FLAGS=-dUSE_AVX2
endif

ifeq ($(USE_STEROIDS),1)
FLAGS+=-dUSE_MULTITHREADING
endif

ifeq ($(USE_OPENBLAS),1)
FLAGS+=-dUSE_OPENBLAS
endif

ifeq ($(USE_TELEMETRY),1)
FLAGS+=-dUSE_TELEMETRY
endif

# use intel's Math Kernel Library (intel oneAPI must be installed and it's dlls must exisits)
ifeq ($(USE_MKL),1)
FLAGS+=-dUSE_MKL
endif

ifeq ($(USE_OPENCL),1)
FLAGS+=-dUSE_OPENCL
endif

ifeq ($(USE_CUDA),1)
FLAGS+=-dUSE_CUDA
endif

ifeq ($(CLBLASTCONV),1)
FLAGS+=-dCLBLASTCONV
endif

all: 
	@$(MKD) $(OUTLIB)
	$(FPC) -v0 -CX -Scghi -Xs -XX -Fu$(UNITS) -Fi$(INCLIB) -FU$(OUTLIB) $(FLAGS) -O3 $(SRC)$(SRC_EXT)
	@echo done!, now try running $(SRC)$(EXE_EXT) executable.

clean: 
	@$(DEL) lib/ *.o *.a *.ppu *.exe *.dbg $(SRC)